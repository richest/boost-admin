import{a as W,F as z,b as K,r as v,j as e,Q as M,G as o,L as N,R as q,V as f,a3 as H,ah as Q,d as k,a4 as J,N as X,g as Y,D as Z}from"./index-Bb4T6yJS.js";import{d as ee}from"./ArrowBack-huGvzFdU.js";import{A as te}from"./helmet-BKDsicQe.js";import{P as se}from"./container-Mdzkb4R0.js";import{P as re}from"./breadcrumbs-BoNbTSIP.js";import{d as oe}from"./Send-CIV9xzto.js";import{u as ne,o as ae,a as D}from"./yup-VhrNJgti.js";import{c as w,f as B,a as U,e as ie}from"./index.esm-B55s2Mzk.js";import{A as L}from"./apiErrorResonse-CCtXlH33.js";import{d as P}from"./Add-CMcxYLjt.js";import{d as F}from"./Delete-DOmi5ats.js";import{B as y}from"./Button-CoPqx7My.js";import{C as R}from"./Card-Cg269qA4.js";import{T as $}from"./Typography-BvK0EBjx.js";import{S as ce}from"./Skeleton-Cv9Q_VQE.js";import{B as le}from"./Box-DzmxXICY.js";import{T as G}from"./TextField-Dv9saPdb.js";import{S as me}from"./Stack-yqW3PSS6.js";import{L as ue}from"./LoadingButton-D3WD33Li.js";import{F as de}from"./FormControlLabel-BSrpgavM.js";import{C as pe}from"./Checkbox-CfveKnSG.js";import"./createSvgIcon-Cvxe-UMk.js";import"./ButtonBase-D0CLtmKS.js";import"./useId-BQiMa7-Q.js";import"./useControlled-DpDQkWSS.js";import"./styled-BzESMtjz.js";import"./Breadcrumbs-CYgmF-zU.js";import"./useSlotProps-CkCdCphK.js";import"./colorManipulator-C6WsgVx8.js";import"./createBox-Z02cO3O7.js";import"./Select-D_KZ1HKa.js";import"./useFormControl-oNyqkk4W.js";import"./Popover-_oog1cCQ.js";import"./Modal-BEZPFFVa.js";import"./Portal-DOJFZdR8.js";import"./Grow-BLrRft-L.js";import"./List-BGusPRli.js";import"./FormHelperText-D8o68a4M.js";import"./SwitchBase-B0q5c7pV.js";const he=w().shape({questions:B().of(w().shape({title:U().trim().required("Question is required."),answers:B().of(w().shape({answer:U().trim().required("Answer is required."),option:ie().required("Option is required.")}))}))});function tt(){var g;const n=W(),i=z(),{loader:h}=K(s=>s.request),[d,I]=v.useState(""),{register:c,setValue:E,handleSubmit:_,trigger:O,control:p,formState:{errors:t}}=ne({mode:"all",resolver:ae(he),defaultValues:{questions:[{title:"",answers:[{answer:"",option:!1}]}]}}),{fields:m,append:x,remove:S}=D({control:p,name:"questions"}),A=async s=>{var a;let r={key:"QUESTION_BANK",section:(a=i==null?void 0:i.state)==null?void 0:a.category,value:JSON.stringify({questions:s.questions}),status:1};try{n({type:f.PROCESSING});const{status:u,data:{message:l}}=await H(Q.UPDATE,r);u===k[200]?(n({type:f.SUCCESS,payload:{message:l}}),J.success(l),j()):n({type:f.FAILURE,payload:{message:L()}})}catch(u){n({type:f.FAILURE,payload:{message:L(u)}})}};async function b(s){n({type:f.INIT_LOADER,payload:{loader:!0}});const r=Z.LOCALE;try{const a=await X(s),{status:u}=a,{data:l,success:C}=a.data;if(C&&u===k[200]){const T=JSON.parse(l==null?void 0:l.value),{questions:V}=T;E("questions",V)}else I(Y[r].FETCHING_USERS_LIST)}catch(a){L(a)}n({type:f.INIT_LOADER,payload:{loader:!1}})}const j=()=>{var s;b(`${Q.GET}?key=QUESTION_BANK&section=${(s=i==null?void 0:i.state)==null?void 0:s.category}`)};return v.useEffect(()=>{j()},[]),e.jsxs(e.Fragment,{children:[e.jsx(te,{title:M.QUESTION_BANK}),e.jsxs(se,{className:"page-container users-page",heading:"Add Questions",children:[e.jsxs(o,{container:!0,justifyContent:"space-between",alignItems:"flex-start",spacing:2,children:[e.jsx(o,{item:!0,children:e.jsx(re,{breadcrumbs:[e.jsx(N,{style:{color:"rgb(99, 115, 129)",textDecoration:"none"},to:q.DASHBOARD,children:"dashboard"}),e.jsx(N,{style:{color:"rgb(99, 115, 129)",textDecoration:"none"},to:q.WEB_CONTENT,children:"web content"}),e.jsx(N,{style:{color:"rgb(99, 115, 129)",textDecoration:"none"},to:q.QUESTION_BANK,children:"Question bank"}),(g=i==null?void 0:i.state)==null?void 0:g.category]})}),e.jsx(o,{item:!0,mr:1,children:e.jsx(N,{className:"h-link",to:q.QUESTION_BANK,children:e.jsx(y,{sx:{borderRadius:"2pt"},variant:"contained",color:"primary",startIcon:e.jsx(ee,{}),children:"Back"})})})]}),e.jsx(R,{sx:{mt:4,boxShadow:3},children:e.jsx(o,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"flex-start",spacing:2,my:2,children:e.jsxs(o,{item:!0,md:12,children:[e.jsx($,{px:3,variant:"h4",children:"Add or update Questions"}),e.jsx(R,{className:"profile-right-section",sx:{p:3},children:e.jsxs("form",{onSubmit:_(A),noValidate:!0,children:[m.map((s,r)=>{var a,u,l,C,T;return e.jsx("div",{children:h?e.jsx(ce,{variant:"rectangular",width:"100%",height:118}):e.jsxs(e.Fragment,{children:[e.jsx(le,{sx:{mb:2},children:e.jsx($,{variant:"h5",children:`Question ${r+1}`})}),e.jsx(o,{mb:4,children:e.jsx(G,{...c(`questions[${r}].title`),label:"Question*",disabled:h,error:!!((u=(a=t==null?void 0:t.questions)==null?void 0:a[r])!=null&&u.title),helperText:(T=(C=(l=t==null?void 0:t.questions)==null?void 0:l[r])==null?void 0:C.title)==null?void 0:T.message,variant:"outlined",fullWidth:!0})}),e.jsx(xe,{index:r,control:p,register:c,errors:t,setValue:E}),m.length>1&&e.jsx(o,{container:!0,direction:"row",justifyContent:"center",mt:2,children:e.jsx(y,{type:"button",size:"medium",startIcon:e.jsx(F,{}),variant:"outlined",onClick:()=>S(r),color:"error",children:"Question"})})]})},s.id)}),e.jsx(o,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",mt:2,children:e.jsx(y,{type:"button",size:"medium",startIcon:e.jsx(P,{}),variant:"outlined",onClick:()=>x({title:"",answers:[{answer:"",option:!1}]}),children:"Question"})}),e.jsx(me,{direction:"row",justifyContent:"center",alignItems:"center",my:2,children:e.jsx(ue,{loading:h,size:"medium",type:"submit",loadingPosition:"end",endIcon:e.jsx(oe,{}),variant:"contained",children:h?"PLEASE WAIT...":"SUBMIT"})})]})})]})})})]})]})}const xe=({index:n,control:i,register:h,errors:d,setValue:I})=>{const{fields:c,append:E,remove:_}=D({control:i,name:`questions[${n}].answers`}),O=(p,t)=>{I(`questions[${n}].answers`,c.map((m,x)=>x===p?{...m,option:t}:{...m,option:!1}))};return e.jsxs(e.Fragment,{children:[c.map((p,t)=>{var m,x,S,A,b,j,g,s,r;return e.jsxs(o,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(o,{item:!0,xs:12,md:7,lg:6,children:e.jsx(o,{mb:2,children:e.jsx(G,{...h(`questions[${n}].answers[${t}].answer`),label:"Answer*",error:!!((A=(S=(x=(m=d==null?void 0:d.questions)==null?void 0:m[n])==null?void 0:x.answers)==null?void 0:S[t])!=null&&A.answer),helperText:(r=(s=(g=(j=(b=d==null?void 0:d.questions)==null?void 0:b[n])==null?void 0:j.answers)==null?void 0:g[t])==null?void 0:s.answer)==null?void 0:r.message,variant:"outlined",fullWidth:!0,InputProps:{endAdornment:e.jsx(de,{control:e.jsx(pe,{checked:!!p.option,onChange:a=>O(t,a.target.checked),color:"primary"}),labelPlacement:"end"})}})})}),(c==null?void 0:c.length)>2&&e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(y,{type:"button",size:"medium",startIcon:e.jsx(F,{}),variant:"outlined",onClick:()=>_(t),color:"error",children:"Answer"})})]},p.id)}),(c==null?void 0:c.length)<4&&e.jsx(o,{container:!0,mt:2,children:e.jsx(y,{type:"button",size:"medium",startIcon:e.jsx(P,{}),variant:"outlined",onClick:()=>E({answer:"",option:!1}),children:"Answer"})})]})};export{tt as default};
