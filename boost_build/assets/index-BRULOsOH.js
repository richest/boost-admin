import{a as V,b as G,r as o,f as J,j as e,G as c,K as Z,a4 as D,V as l,a3 as ee,a7 as O,d as v,R as Q,e as te,Q as se,L as re,N as B,g as oe,D as ae}from"./index-Bb4T6yJS.js";import{A as ne}from"./helmet-BKDsicQe.js";import{P as ie}from"./container-Mdzkb4R0.js";import{P as ce}from"./breadcrumbs-BoNbTSIP.js";import{A as x}from"./apiErrorResonse-CCtXlH33.js";import{d as le}from"./ArrowBack-huGvzFdU.js";import{d as me}from"./AddAPhoto-D4lISSRu.js";import{d as de}from"./Send-CIV9xzto.js";import{d as pe}from"./CancelTwoTone-g9I4gqmS.js";import"./ckeditor-DoMhieYw.js";import"./antSwitch-BKUKAnS9.js";import{u as ue,o as fe}from"./yup-VhrNJgti.js";import{c as ge,a as U,d as xe}from"./index.esm-B55s2Mzk.js";import{V as F}from"./regexRules-CPrFAOdY.js";import{C as z}from"./Card-Cg269qA4.js";import{A as he}from"./Avatar-CkCB1SYh.js";import{T as Se}from"./Tooltip-BPIgMGiH.js";import{F as w}from"./FormHelperText-D8o68a4M.js";import{S as q}from"./Stack-yqW3PSS6.js";import{T as H,I as Ee}from"./TextField-Dv9saPdb.js";import{F as je,S as ye}from"./Select-D_KZ1HKa.js";import{M as Ie}from"./MenuItem-Ym5Ln7NP.js";import{L as _e}from"./LoadingButton-D3WD33Li.js";import{B as Te}from"./Button-CoPqx7My.js";import"./styled-BzESMtjz.js";import"./Typography-BvK0EBjx.js";import"./Breadcrumbs-CYgmF-zU.js";import"./ButtonBase-D0CLtmKS.js";import"./useSlotProps-CkCdCphK.js";import"./createSvgIcon-Cvxe-UMk.js";import"./useId-BQiMa7-Q.js";import"./useControlled-DpDQkWSS.js";import"./Switch-Dc5i2Mqq.js";import"./SwitchBase-B0q5c7pV.js";import"./useFormControl-oNyqkk4W.js";import"./index-D8g0v2aH.js";import"./useSlot-KITjY7au.js";import"./Popper-BrZsYCFQ.js";import"./Portal-DOJFZdR8.js";import"./Grow-BLrRft-L.js";import"./Popover-_oog1cCQ.js";import"./Modal-BEZPFFVa.js";import"./List-BGusPRli.js";import"./dividerClasses-B4fnud8L.js";import"./listItemTextClasses-Kx3W7iDp.js";import"./listItemIconClasses-CKdqSC5K.js";const Ce=ge().shape({name:U().required(`${F.NAME.REQUIRED}`).max(30,`${F.NAME.MAX_LENGTH}`),description:U(),product_type_id:U().required(F.PRODUCT_TYPE.REQUIRED),icon:xe().test("fileSize","Icon's size cannot be more than 5 MB",(a,t)=>{var i;const{preSelectedImage:n}=t.options.context;return n||a.length===0?!0:((i=a[0])==null?void 0:i.size)<=5242880}).test("fileType","Only *.jpeg, *.jpg, *.png types are allowed.",(a,t)=>{var i;const{preSelectedImage:n}=t.options.context;return n||a.length===0?!0:["image/jpeg","image/png","image/jpg"].includes((i=a[0])==null?void 0:i.type)})});function Pe({productTypeList:a,productDetails:t}){const n=V(),{loader:i,message:N,messageType:M}=G(s=>s.request),[$,y]=o.useState(!1),h=G(s=>s.customization),[u,P]=o.useState(null),[m,R]=o.useState(null),S=J(),{register:E,setValue:k,handleSubmit:A,trigger:I,reset:_,formState:{errors:r}}=ue({mode:"all",resolver:fe(Ce),context:{preSelectedImage:m}}),[d,j]=o.useState(!1),[p,f]=o.useState();o.useState(!1);const{onChange:T,...b}=E("icon"),W=async s=>{var C;if(m===null||((C=s.icon)==null?void 0:C.length)===0)D.error("Icon is required");else{let g=new FormData;g.append("name",s.name),g.append("description",s.description),g.append("product_type_id",p),m?g.append("icon",m):s.icon.length>0&&g.append("icon",s.icon[0]);try{n({type:l.PROCESSING});const{status:L,data:{message:X}}=await ee(`${O.UPDATE}/${t.id}`,g);L===v[200]?(n({type:l.SUCCESS,payload:{message:X}}),S(Q.PRODUCTS_LIST)):n({type:l.FAILURE,payload:{message:x()}}),window.scrollTo(0,0)}catch(L){n({type:l.FAILURE,payload:{message:x(L)}})}}},Y=()=>{y(!0)},K=()=>{i||y(!1)};return o.useEffect(()=>{R(t==null?void 0:t.icon),j(!!(t!=null&&t.status))},[t]),o.useEffect(()=>{var s;t&&(_({name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",icon:(t==null?void 0:t.icon)||null}),f(((s=t==null?void 0:t.product_type)==null?void 0:s.id)||""))},[_,t]),e.jsx(e.Fragment,{children:e.jsxs(c,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"flex-start",spacing:2,my:2,children:[e.jsx(c,{item:!0,md:4,children:e.jsxs(z,{className:"profile-left-section",sx:{px:2,py:3,overflow:"hidden",boxShadow:1,background:h.navType==="dark"?"#103C65":"#fff"},children:[e.jsxs(c,{container:!0,direction:"column",justifyContent:"center",alignItems:"center",position:"relative",sx:{marginTop:"20px"},children:[e.jsxs("div",{onMouseEnter:Y,onMouseLeave:K,children:[e.jsx(he,{alt:"",sx:{width:120,height:120,border:`2px dashed ${r.icon?"#ff4842":"#3273ba"}`,color:`${r.icon?"#ff4842":"#fff"}`},color:"danger",src:m||u&&URL.createObjectURL(u)}),m||u!=null?e.jsx(Se,{placement:"top",title:"Click to remove icon",children:e.jsx(pe,{sx:{color:Z.ERROR_MSG_COLOR,background:"#fff",borderRadius:"50%",position:"absolute",top:0,left:"55%",cursor:"pointer",fontSize:"18px"},onClick:()=>{P(null),R(null),y(!1),T({target:{name:"icon",value:[]}}),I("icon")}})}):"",!m&&!u&&e.jsx("div",{style:{textAlign:"center"},children:e.jsx("label",{className:"uploadFileInput",htmlFor:"uploadFileInput",children:e.jsx(me,{color:"#fff"})})}),e.jsx("input",{...b,type:"file",id:"uploadFileInput",accept:"image/*",name:"icon",onChange:s=>{P(s.target.files[0]),T(s),I("icon")},style:{display:"none"}})]}),r.icon&&e.jsx(w,{sx:{my:2,px:5,textAlign:"center"},error:!0,children:r.icon.message})]}),e.jsx(q,{direction:"row",justifyContent:"space-between",alignItems:"center",justifyItems:"center",width:"100%",mb:2,style:{textAlign:"center"},children:e.jsx(w,{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",color:h.navType==="dark"?"#fff":"#000"},children:"Click to upload product icon"})})]})}),e.jsx(c,{item:!0,md:8,children:e.jsx(z,{className:"profile-right-section",sx:{p:3,boxShadow:1,background:h.navType==="dark"?"#103C65":"#fff"},children:e.jsxs("form",{onSubmit:A(W),noValidate:!0,children:[e.jsxs(c,{container:!0,spacing:2,mb:3,children:[e.jsx(c,{item:!0,md:6,children:e.jsx(H,{...E("name"),label:"Name*",disabled:i,error:!!r.name,helperText:r.name?r.name.message:"",variant:"outlined",fullWidth:!0})}),e.jsx(c,{item:!0,md:6,children:e.jsxs(je,{fullWidth:!0,error:!!r.product_type_id,children:[e.jsx(Ee,{id:"demo-simple-select-label",children:"Product Type"}),e.jsx(ye,{...E("product_type_id"),label:"Product Type*",value:String(p),onChange:s=>{f(s.target.value)},children:(a==null?void 0:a.length)>0&&(a==null?void 0:a.map((s,C)=>e.jsx(Ie,{value:s.id,children:s.name},C)))}),r.product_type_id&&e.jsx(w,{sx:{ml:"15px"},error:!0,children:r.product_type_id.message})]})})]}),e.jsx(c,{container:!0,spacing:2,mb:3,children:e.jsx(c,{item:!0,md:12,children:e.jsx(H,{...E("description"),fullWidth:!0,multiline:!0,error:!!r.description,helperText:r.description?r.description.message:"",label:"Description*",rows:4})})}),e.jsx(q,{direction:"row",justifyContent:"flex-end",alignItems:"center",my:2,children:e.jsx(_e,{loading:!!i,size:"medium",type:"submit",loadingPosition:"end",endIcon:e.jsx(de,{}),variant:"contained",children:i?"PLEASE WAIT...":"SUBMIT"})})]})})})]})})}function Et(){const{id:a}=te(),t=V(),[n,i]=o.useState(),[N,M]=o.useState([]),[$,y]=o.useState(10),[h,u]=o.useState(1),[P,m]=o.useState(""),[R,S]=o.useState(!1),[E,k]=o.useState(null),A=()=>{I(`${O.LIST_TYPE}`),_(a)};async function I(r){S(!0),t({type:l.INIT_LOADER,payload:{loader:!0}});let d;const j=ae.LOCALE;try{const p=await B(r),{status:f}=p,{data:{productsDetails:T},success:b}=p.data;b&&f===v[200]?(M(T.rows),S(!1),t({type:l.INIT_LOADER,payload:{loader:!1}})):(m(oe[j].FETCHING_USERS_LIST),t({type:l.FAILURE,payload:{message:x()}}))}catch(p){d=x(p),m(d),S(!1),t({type:l.FAILURE,payload:{message:d}})}}async function _(r){t({type:l.PROCESSING});try{const d=await B(`${O.GET_PRODUCT}/${r}`),{status:j}=d,{data:p,success:f}=d.data;f&&j===v[200]?(t({type:l.SUCCESS,payload:{message:""}}),i(p.productDetails)):t({type:l.FAILURE,payload:{message:x()}})}catch(d){t({type:l.FAILURE,payload:{message:x(d)}})}}return o.useEffect(()=>{A()},[h,$]),o.useEffect(()=>{k(n==null?void 0:n.icon)},[n]),e.jsxs(e.Fragment,{children:[e.jsx(ne,{title:se.EDIT_PRODUCT}),e.jsxs(ie,{className:"page-container users-page",heading:"Edit product",children:[e.jsxs(c,{container:!0,justifyContent:"space-between",alignItems:"flex-start",spacing:2,children:[e.jsx(c,{item:!0,children:e.jsx(ce,{breadcrumbs:["dashborad","product","edit"]})}),e.jsx(c,{item:!0,mr:1,children:e.jsx(re,{className:"h-link",to:Q.PRODUCTS_LIST,children:e.jsx(Te,{sx:{borderRadius:"2pt"},variant:"contained",color:"primary",startIcon:e.jsx(le,{}),children:"Back"})})})]}),e.jsx(Pe,{productDetails:n,productTypeList:N})]})]})}export{Et as default};
